---
title: "R Notebook"
output: html_notebook
---

```{r}
#required libraries
library(ggplot2)
library(car)
library(dplyr)
library(reshape2)
library(pwr)
library(irr)
library(coin)
```
```{r}
data <- read.table("order_study_data.csv", sep=",", header=TRUE)
head(data)
```

```{r}
data <- group_by(data, condition)
aggregate <- summarise(data,
                       n = length(condition),
                         #mean ratings
                       med_total_orig = median(sum_orig),   
                       avg_total_orig = mean(sum_orig),
                          sd_total_orig = sd(sum_orig),
                          se_total_orig = sd_total_orig/sqrt(length(condition)),
                      med_avg_orig = median(sum_orig),   
                       avg_orig = mean(orig),
                          sd_avg_orig = sd(orig),
                          se_avg_orig = sd_avg_orig/sqrt(length(condition)),
                       med_total_util = median(sum_util),
                          avg_total_util = mean(sum_util),
                          sd_total_util = sd(sum_util),
                          se_total_util = sd_total_util/sqrt(length(condition)),
                       med_avg_util = median(util),   
                       avg_util = mean(util),
                          sd_avg_util = sd(util),
                          se_avg_util = sd_avg_util/sqrt(length(condition)),
                      sum = mean(sum_total),
                      sd_sum = sd(sum_total),
                      se_sum = sd_sum/sqrt(length(condition)))

aggregate
```
```{r}
time <- summarise(data,
                  #first design
                  med_orig_t1 = median(orig_t1),
                  avg_orig_t1 = mean(orig_t1),
                  sd_orig_t1 = sd(orig_t1),
                  se_orig_t1 = sd_orig_t1/sqrt(length(condition)),
                  med_util_t1 = median(util_t1),
                  avg_util_t1 = mean(util_t1),
                  sd_util_t1 = sd(util_t1),
                  se_util_t1 = sd_util_t1/sqrt(length(condition)),
                  mean_sum_t1 = mean(sum_t1),
                  sd_sum_t1 = sd(sum_t1),
                  se_sum_t1 = sd_sum_t1/sqrt(length(condition)),
                  #second design
                  med_orig_t2 = median(orig_t2),
                  avg_orig_t2 = mean(orig_t2),
                  sd_orig_t2 = sd(orig_t2),
                  se_orig_t2 = sd_orig_t2/sqrt(length(condition)),
                  med_util_t2 = median(util_t2),
                  avg_util_t2 = mean(util_t2),
                  sd_util_t2 = sd(util_t2),
                  se_util_t2 = sd_util_t2/sqrt(length(condition)),
                  mean_sum_t2 = mean(sum_t2),
                  sd_sum_t2 = sd(sum_t2),
                  se_sum_t2 = sd_sum_t2/sqrt(length(condition)))

time
```

```{r}
irr <- read.table("irr_order.csv",sep=",",header=TRUE)
irr <- as.matrix(irr)

kappa2(irr, "equal")
```

```{r}
#comparing the sum totals for originality and utility across t1 and t2
wilcox.test(data$sum_orig~data$condition)
wilcox.test(data$sum_util~data$condition)
```

```{r}
#randomization test comparing sum originality and sum utility across t1 and t2
independence_test(condition ~ sum_orig, data = data)
independence_test(condition ~ sum_util, data = data)
```

```{r}
#comparing t2 orig and util
wilcox.test(data$orig_t2~data$condition)
wilcox.test(data$util_t2~data$condition)
```
```{r}
#randomization test for t2 orig and util
independence_test(condition ~ orig_t2, data = data)
independence_test(condition ~ util_t2, data = data)
```

```{r}
#comparing t1 orig and util
wilcox.test(data$orig_t1~data$condition)
wilcox.test(data$util_t1~data$condition)
```
```{r}
#randomization test for t2 orig and util
independence_test(condition ~ orig_t1, data = data)
independence_test(condition ~ util_t1, data = data)
```
```{r}
wilcox.test(data$sum_t1~data$condition)
wilcox.test(data$sum_t2~data$condition)
wilcox.test(data$sum_total~data$condition)
```

```{r}
#randomization test for sum scores
independence_test(condition ~ sum_t1, data=data)
independence_test(condition ~ sum_t2, data=data)
independence_test(condition ~ sum_total, data=data)
```

```{r}
#filter data into conditions
explore_first <- data %>%
  filter(condition=="green")

exploit_first <- data %>%
  filter(condition=="blue")
```
```{r}
#repeated measures paired t-tests for originality between designs
t.test(explore_first$orig_t2,explore_first$orig_t1, paired=TRUE)
t.test(exploit_first$orig_t2,exploit_first$orig_t1, paired=TRUE)
```
```{r}
#repeated measures paired t-tests for utility between designs
t.test(explore_first$util_t2,explore_first$util_t1, paired=TRUE)
t.test(exploit_first$util_t2,exploit_first$util_t1, paired=TRUE)
```
```{r}
ggplot(data, aes(x=diff_orig, color=condition)) +
  geom_histogram(fill="white", alpha=0.5, position="dodge") +
  theme_bw()

ggplot(data, aes(x=diff_util, color=condition)) +
  geom_histogram(fill="white", alpha=0.5, position="dodge") +
  theme_bw()
```

